# 智能家居语音助手系统设计文档

## 目录
- [智能家居语音助手系统设计文档](#智能家居语音助手系统设计文档)
  - [目录](#目录)
  - [1. 总体设计](#1-总体设计)
    - [1.1 系统架构](#11-系统架构)
    - [1.2 模块划分](#12-模块划分)
  - [2. 详细设计](#2-详细设计)
    - [2.1 后端设计](#21-后端设计)
    - [2.2 前端设计](#22-前端设计)
    - [2.3 NLP服务设计](#23-nlp服务设计)
    - [2.4 数据库设计](#24-数据库设计)
    - [2.5 接口设计](#25-接口设计)
      - [设备控制接口](#设备控制接口)
      - [语音命令接口](#语音命令接口)
      - [设置接口](#设置接口)
    - [2.6 界面设计](#26-界面设计)
  - [3. 系统数据流与交互](#3-系统数据流与交互)
    - [3.1 数据流向图](#31-数据流向图)
    - [3.2 语音命令处理数据流](#32-语音命令处理数据流)
    - [3.3 设备控制数据流](#33-设备控制数据流)
    - [3.4 系统组件间通信机制](#34-系统组件间通信机制)
  - [4. UML图表](#4-uml图表)
    - [4.1 系统组件图](#41-系统组件图)
    - [4.2 语音指令处理流程图](#42-语音指令处理流程图)
    - [4.3 设备控制序列图](#43-设备控制序列图)
    - [4.4 类图关系](#44-类图关系)
    - [4.5 部署架构图](#45-部署架构图)

## 1. 总体设计

### 1.1 系统架构

智能家居语音助手采用分布式微服务架构，由三大核心部分组成：

1. **前端应用**：基于React开发的移动友好型Web应用，提供语音交互界面
2. **后端服务**：使用Spring Boot构建的RESTful API服务
3. **NLP服务**：独立的Python语音处理微服务，负责STT(语音转文本)、NLU(自然语言理解)和TTS(文本转语音)

系统采用分层架构思想，包括：

- **表现层**：React前端UI组件和Spring控制器
- **业务逻辑层**：前端服务和后端服务实现
- **数据访问层**：JPA实体和存储库
- **数据存储层**：H2/MySQL数据库
、

### 1.2 模块划分

系统主要划分为以下功能模块：

1. **设备控制模块**：管理智能设备的状态和操作
   - 设备状态管理
   - 设备操作执行
   - 设备信息维护

2. **语音处理模块**：
   - 语音识别(STT)
   - 自然语言理解(NLU)
   - 文本到语音转换(TTS)

3. **用户交互模块**：
   - 语音输入界面
   - 结果显示
   - 反馈机制

4. **系统设置模块**：
   - 语音引擎设置
   - UI主题设置
   - 系统参数配置

5. **数据存储模块**：
   - 设备数据持久化
   - 配置信息存储
   - 日志记录

各模块相互独立又协同工作，保证了系统功能的完整性和高内聚低耦合的设计原则。

## 2. 详细设计

### 2.1 后端设计

后端采用Spring Boot框架，基于RESTful API设计原则构建，主要结构如下：

```
backend/
├── src/main/java/com/smarthome/assistant/
│   ├── controller/       # REST API控制器
│   ├── service/          # 业务逻辑服务
│   ├── repository/       # 数据访问层
│   ├── model/            # 数据模型
│   ├── entity/           # 持久化实体
│   ├── dto/              # 数据传输对象
│   ├── config/           # 配置类
│   ├── exception/        # 异常处理
│   ├── util/             # 工具类
│   └── SmartHomeApplication.java # 应用入口
```

主要功能组件：

1. **控制器层**：
   - `DeviceController`：设备控制API
   - `VoiceCommandController`：语音命令处理
   - `SettingsController`：系统设置管理
   - `VoiceController`：语音服务接口

2. **服务层**：
   - `DeviceService`：设备管理服务
   - `CommandProcessingService`：命令处理服务
   - `NLPService`：NLP服务客户端

3. **数据访问层**：
   - `DeviceRepository`：设备数据访问

### 2.2 前端设计

前端采用React框架，使用现代JavaScript构建响应式单页应用，主要结构如下：

```
frontend/
├── src/
│   ├── components/       # UI组件
│   ├── pages/            # 页面组件
│   ├── contexts/         # React上下文
│   ├── services/         # API服务
│   ├── styles/           # CSS样式
│   ├── App.js            # 应用根组件
│   └── index.js          # 入口文件
```

主要组件：

1. **页面组件**：
   - `Home`：主页面
   - `MobilePhoneView`：移动设备视图
   - `MobileSettings`：设置页面
   - `Weather`：天气页面
   - `MobileOnboarding`：引导页面

2. **UI组件**：
   - `MobileContainer`：移动设备容器
   - `VoiceInput`：语音输入组件
   - `TypingAnimation`：打字动画效果
   - `Layout`：布局组件

3. **服务层**：
   - `api.js`：统一API调用服务

### 2.3 NLP服务设计

NLP服务是一个基于Python的独立微服务，使用FastAPI框架构建，主要结构如下：

```
nlp_service/
├── app/
│   ├── main.py           # FastAPI应用
│   ├── orchestrator.py   # 服务编排器
│   └── __init__.py
├── stt/                  # 语音转文本模块
├── nlu/                  # 自然语言理解模块
├── tts/                  # 文本转语音模块
├── interfaces/           # 接口定义
├── config/               # 配置文件
└── start_service.py      # 服务启动脚本
```

NLP服务处理流程：

1. 接收语音或文本输入
2. 如果是语音输入，通过STT转换为文本
3. 使用NLU分析文本，提取意图和实体
4. 生成响应
5. 如果需要，使用TTS将文本转换为语音
6. 返回处理结果

### 2.4 数据库设计

系统使用的数据库表结构如下：

**设备表(Device)**:

| 字段名 | 数据类型 | 说明 |
| ------ | -------- | ---- |
| id | VARCHAR(255) | 主键，设备ID |
| name | VARCHAR(255) | 设备名称 |
| type | VARCHAR(255) | 设备类型(灯、空调等) |
| status | VARCHAR(255) | 设备状态(开/关) |
| location | VARCHAR(255) | 设备位置 |
| brightness | INTEGER | 灯光亮度 |
| color | VARCHAR(255) | 灯光颜色 |
| temperature | INTEGER | 空调温度 |
| mode | VARCHAR(255) | 设备模式 |
| fan_speed | VARCHAR(255) | 风扇速度 |
| position | INTEGER | 窗帘位置 |
| volume | INTEGER | 电视音量 |
| channel | INTEGER | 电视频道 |
| humidity | INTEGER | 空气湿度 |
| speed | VARCHAR(255) | 风扇速度 |

### 2.5 接口设计

系统提供的主要RESTful API接口如下：

#### 设备控制接口

1. **获取所有设备**
   - **URL**: `/api/devices`
   - **方法**: GET
   - **返回**: 所有设备列表

2. **获取单个设备**
   - **URL**: `/api/devices/{id}`
   - **方法**: GET
   - **参数**: `id` - 设备ID
   - **返回**: 单个设备信息

3. **控制设备**
   - **URL**: `/api/devices/{id}/control`
   - **方法**: POST
   - **参数**: 
     - `id` - 设备ID
     - 请求体: `{ "action": "操作名称", "params": {} }`
   - **返回**: 更新后的设备信息

#### 语音命令接口

1. **处理语音命令**
   - **URL**: `/api/command/audio`
   - **方法**: POST
   - **参数**: 
     - `audio_file` - 音频文件(FormData)
     - `settingsJson` - 语音处理设置(JSON字符串)
   - **返回**: 命令处理结果

2. **处理文本命令**
   - **URL**: `/api/command/text`
   - **方法**: POST
   - **参数**: 
     - 请求体: `{ "textInput": "命令文本", "settings": {} }`
   - **返回**: 命令处理结果

#### 设置接口

1. **获取语音设置**
   - **URL**: `/api/voice/settings`
   - **方法**: GET
   - **返回**: 当前语音设置

2. **更新语音设置**
   - **URL**: `/api/voice/settings`
   - **方法**: POST
   - **参数**: 请求体: 设置JSON对象
   - **返回**: 操作结果

3. **重置语音设置**
   - **URL**: `/api/voice/settings/reset`
   - **方法**: POST
   - **返回**: 操作结果

### 2.6 界面设计

系统采用移动优先的设计原则，主要为移动端用户提供友好的交互体验。界面设计包括：

1. **主界面**
   - 语音指令输入区域
   - 语音反馈/应答显示区域
   - 快捷指令按钮
   - 设备状态卡片

2. **设置界面**
   - 语音引擎选项设置
   - 语音识别参数调整
   - 界面主题设置

3. **设备控制面板**
   - 设备开关控制
   - 详细参数调整
   - 状态显示

主要采用简洁、直观的设计风格，使用大按钮和清晰可见的控件，优化移动触摸体验。系统提供亮色和暗色两种主题模式，以适应不同用户的偏好和使用场景。

## 3. 系统数据流与交互

### 3.1 数据流向图

智能家居语音助手系统中的数据流动主要涉及以下几个主要方向：

```
+---------------------+         音频数据           +---------------------+
|                     +-------------------------->|                     |
|                     |                           |                     |
|      前端应用        |         文本命令           |     Spring Boot     |
|      (React)        +-------------------------->|      后端服务        |
|                     |                           |                     |
|                     |         响应数据           |                     |
|                     |<--------------------------+                     |
+---------------------+                           +----------+----------+
                                                           ^ |
                                                           | |
                                            文本/命令解析请求 | | 处理结果
                                                           | v
                                                  +--------+---------+
                                                  |                  |
                                                  |    NLP服务        |
                                                  | (Python/FastAPI) |
                                                  |                  |
                                                  +-------+----------+
                                                          ^
                                                          |
                                                          v
                                                  +------------------+
                                                  |   外部NLP服务     |
                                                  | (如Whisper/BERT) |
                                                  +------------------+
```

### 3.2 语音命令处理数据流

语音命令从用户输入到执行设备控制的完整数据流过程:

1. **语音采集阶段**：
   - 用户通过前端应用的VoiceInput组件录制语音
   - 语音数据被转换为Blob对象并存储在FormData对象中
   - 相关语音处理设置（如STT引擎、NLU引擎选择）被添加到请求中

2. **语音传输阶段**：
   - 前端通过POST请求将FormData发送到后端API `/api/command/audio`
   - 请求包含：语音文件、语音设置参数
   - 使用multipart/form-data格式进行传输

3. **后端处理阶段**：
   - VoiceCommandController接收请求
   - 提取音频文件和设置参数
   - 通过HTTP请求将音频传递给NLP服务

4. **语音识别阶段**：
   - NLP服务的orchestrator.py协调处理流程
   - 使用配置的STT引擎（如Whisper）将语音转换为文本
   - STT处理结果包含识别文本和置信度

5. **语义理解阶段**：
   - NLU模块接收识别的文本
   - 使用配置的NLU引擎（如fine_tuned_bert）分析文本
   - 提取意图（如打开设备）和实体（如设备类型、位置）
   - 生成结构化的意图数据

6. **命令执行阶段**：
   - 结构化意图数据返回给后端服务
   - 后端服务调用DeviceService执行相应的设备控制操作
   - 更新设备状态并记录操作日志

7. **响应生成阶段**：
   - 后端服务生成操作结果
   - 如启用TTS，调用NLP服务将响应文本转换为语音
   - 将结果（文本和可选的语音URL）打包为JSON响应

8. **前端呈现阶段**：
   - 前端接收JSON响应
   - 显示操作结果文本
   - 如有语音响应，播放语音
   - 更新UI以反映设备状态变化

数据流图：

```
+--------+     +--------+     +--------+     +--------+     +--------+     +--------+     +--------+
|        |     |        |     |        |     |        |     |        |     |        |     |        |
|  语音   +---->+  音频   +---->+  文本   +---->+  意图   +---->+  执行   +---->+  状态   +---->+  响应   |
|  输入   |     |  传输   |     |  识别   |     |  理解   |     |  命令   |     |  更新   |     |  呈现   |
|        |     |        |     |        |     |        |     |        |     |        |     |        |
+--------+     +--------+     +--------+     +--------+     +--------+     +--------+     +--------+
 前端应用         前端->后端       后端->NLP       NLP服务        后端服务       数据库         后端->前端
```

### 3.3 设备控制数据流

通过前端界面或语音控制设备的数据流程:

1. **用户请求阶段**:
   - 来源1: 用户通过UI界面点击设备控制按钮
   - 来源2: 用户通过语音发出控制指令
   - 控制数据包含：设备ID、操作类型、操作参数

2. **前端处理阶段**:
   - 用户界面操作转换为API调用参数
   - 通过deviceApi.controlDevice()函数发送请求
   - 请求参数格式: `{ action: "操作名称", params: {} }`

3. **后端控制处理阶段**:
   - DeviceController.controlDevice()接收请求
   - 参数验证和权限检查
   - 调用DeviceService执行实际操作

4. **设备状态更新阶段**:
   - DeviceService更新内部设备状态模型
   - 数据持久化到数据库
   - 可选：触发物理设备控制（如通过IoT网关）

5. **响应返回阶段**:
   - 生成操作结果响应对象
   - 返回更新后的设备状态
   - 前端更新UI显示

设备操作数据结构:

```json
// 示例：调整客厅灯光亮度的请求
{
  "action": "setBrightness",
  "params": {
    "value": 75
  }
}

// 示例：更改空调温度的请求
{
  "action": "setTemperature",
  "params": {
    "value": 24
  }
}
```

### 3.4 系统组件间通信机制

系统各组件之间采用不同的通信机制，确保数据高效传输和处理:

1. **前端与后端通信**:
   - **通信协议**: REST API over HTTP
   - **数据格式**: JSON (应用/设备数据), FormData (语音文件)
   - **通信库**: 前端使用Axios发起HTTP请求
   - **异常处理**: 网络错误重试, 自动端口切换尝试
   - **示例代码**:
     ```javascript
     // 前端API调用示例
     const response = await api.post('/command/audio', formData, {
       headers: { 'Content-Type': 'multipart/form-data' },
       timeout: 60000 // 1分钟超时
     });
     ```

2. **后端与NLP服务通信**:
   - **通信协议**: HTTP API
   - **数据格式**: JSON (文本命令), Multipart (音频文件)
   - **通信工具**: 后端使用Spring的RestTemplate或OkHttp客户端
   - **服务发现**: 通过配置文件指定NLP服务地址
   - **示例数据**:
     ```json
     // 发送到NLP服务的文本命令示例
     {
       "text": "打开客厅的灯",
       "options": {
         "nlu_engine": "fine_tuned_bert",
         "confidence_threshold": 0.7
       }
     }
     ```

3. **数据流与状态管理**:
   - 前端使用React状态管理维护UI状态
   - 后端使用JPA维护数据持久化
   - 系统采用请求-响应模式，不保持长连接
   - 设备状态变化通过轮询或响应触发更新

4. **数据转换流程**:
   
   **语音识别流程数据转换**:
   ```
   音频文件(Blob)
       ↓
   字节流传输到后端
       ↓
   后端转发到NLP服务
       ↓
   音频转换为特征向量
       ↓
   STT模型将特征转为文本
       ↓
   文本结果(String)
   ```
   
   **意图理解流程数据转换**:
   ```
   文本命令(String)
       ↓
   文本预处理(分词)
       ↓
   NLU模型分析
       ↓
   意图结构(JSON)
       ↓
   设备操作映射
       ↓
   具体设备控制指令
   ```

**完整系统数据流通路径**:

```
+-------------+   1.录制语音   +-------------+
|             |-------------->|             |
|    用户      |               |  前端应用    |
|             |<--------------|             |
+-------------+   8.操作反馈   +-------------+
                                   |  ^
                     2.发送音频请求 |  | 7.返回操作结果
                                   v  |
                              +-------------+
                              |             |
                              |   后端服务   |
                              |             |
                              +-------------+
                                   |  ^
                      3.转发音频    |  | 6.返回分析结果
                                   v  |
                              +-------------+
                              |             |
                              |   NLP服务   |
                              |             |
                              +-------------+
                                   |  ^
             4.调用语音识别和意图分析 |  | 5.返回识别/理解结果
                                   v  |
                              +-------------+
                              |  外部NLP服务 |
                              | (如Whisper) |
                              +-------------+
```

## 4. UML图表

### 4.1 系统组件图

系统的详细组件关系图如下：

```
+---------------------------------------------------------------------------------------------------+
|                                         智能家居语音助手系统                                          |
+---------------------------------------------------------------------------------------------------+
                                                |
                +-------------------------------+--------------------------------+
                |                               |                                |
    +-----------v-----------+      +------------v------------+      +------------v------------+
    |     前端应用层          |      |        后端服务层        |      |       NLP服务层          |
    | (React Single Page App)|      |      (Spring Boot)      |      |     (Python/FastAPI)    |
    +-----------------------+      +-----------------------+      +-----------------------+
    |                       |      |                       |      |                       |
    | +-------------------+ |      | +-------------------+ |      | +-------------------+ |
    | |     页面组件       | |      | |     控制器层       | |      | |    音频处理模块     | |
    | | - Home           | |      | | - DeviceController | |      | | - 音频格式转换     | |
    | | - MobilePhoneView| |<---->| | - VoiceController  | |<---->| | - 降噪处理        | |
    | | - MobileSettings | |  API | | - SettingsController| |  API | | - 特征提取        | |
    | +-------------------+ |      | +-------------------+ |      | +-------------------+ |
    |                       |      |                       |      |                       |
    | +-------------------+ |      | +-------------------+ |      | +-------------------+ |
    | |     UI组件        | |      | |     服务层         | |      | |    STT模块        | |
    | | - VoiceInput     | |      | | - DeviceService   | |      | | - Whisper引擎     | |
    | | - MobileContainer| |      | | - CommandService  | |      | | - 语音识别处理     | |
    | | - Layout         | |      | | - NLPClient      | |      | | - 文本生成        | |
    | +-------------------+ |      | +-------------------+ |      | +-------------------+ |
    |                       |      |                       |      |                       |
    | +-------------------+ |      | +-------------------+ |      | +-------------------+ |
    | |    服务调用层      | |      | |   数据访问层      | |      | |    NLU模块        | |
    | | - api.js         | |      | | - DeviceRepository| |      | | - 意图识别        | |
    | | - 状态管理        | |      | | - 事务管理        | |      | | - 实体提取        | |
    | | - 异常处理        | |      | | - 数据映射        | |      | | - 上下文管理      | |
    | +-------------------+ |      | +-------------------+ |      | +-------------------+ |
    |                       |      |          |            |      |                       |
    +-----------------------+      +----------+------------+      | +-------------------+ |
                                               |                   | |    TTS模块        | |
                                   +-----------v-----------+       | | - 语音合成        | |
                                   |      数据存储层        |       | | - 语调控制        | |
                                   |     (H2/MySQL)        |       | | - 音频生成        | |
                                   +-----------------------+       | +-------------------+ |
                                   | - Device表            |       |                       |
                                   | - 配置数据            |       +-----------------------+
                                   | - 日志记录            |
                                   +-----------------------+
```

### 4.2 语音指令处理流程图

语音指令处理的详细流程图如下：

```
+--------+        +--------+        +--------+        +--------+        +--------+
|  用户   |        |  前端   |        |  后端   |        | NLP服务  |        |  设备   |
+--------+        +--------+        +--------+        +--------+        +--------+
    |                 |                 |                 |                 |
    | 发出语音指令      |                 |                 |                 |
    |---------------->|                 |                 |                 |
    |                 |                 |                 |                 |
    |                 | 录制并处理语音    |                 |                 |
    |                 |--------+        |                 |                 |
    |                 |        |        |                 |                 |
    |                 |<-------+        |                 |                 |
    |                 |                 |                 |                 |
    |                 | 发送音频文件      |                 |                 |
    |                 |---------------->|                 |                 |
    |                 |                 |                 |                 |
    |                 |                 | 转发音频文件      |                 |
    |                 |                 |---------------->|                 |
    |                 |                 |                 |                 |
    |                 |                 |                 | 语音转文本(STT)   |
    |                 |                 |                 |--------+        |
    |                 |                 |                 |        |        |
    |                 |                 |                 |<-------+        |
    |                 |                 |                 |                 |
    |                 |                 |                 | 文本理解(NLU)     |
    |                 |                 |                 |--------+        |
    |                 |                 |                 |        |        |
    |                 |                 |                 |<-------+        |
    |                 |                 |                 |                 |
    |                 |                 |                 | 返回意图和实体    |
    |                 |                 |<----------------|                 |
    |                 |                 |                 |                 |
    |                 |                 | 映射到设备操作     |                 |
    |                 |                 |--------+        |                 |
    |                 |                 |        |        |                 |
    |                 |                 |<-------+        |                 |
    |                 |                 |                 |                 |
    |                 |                 | 执行设备操作      |                 |
    |                 |                 |---------------------------------->|
    |                 |                 |                 |                 | 更新状态
    |                 |                 |                 |                 |--------+
    |                 |                 |                 |                 |        |
    |                 |                 |                 |                 |<-------+
    |                 |                 |                 |                 |
    |                 |                 | 返回操作结果      |                 |
    |                 |                 |<----------------------------------|
    |                 |                 |                 |                 |
    |                 |                 | 生成文本响应      |                 |
    |                 |                 |--------+        |                 |
    |                 |                 |        |        |                 |
    |                 |                 |<-------+        |                 |
    |                 |                 |                 |                 |
    |                 |                 | 文本转语音(可选)   |                 |
    |                 |                 |---------------->|                 |
    |                 |                 |                 |                 |
    |                 |                 |                 | 生成语音响应      |
    |                 |                 |                 |--------+        |
    |                 |                 |                 |        |        |
    |                 |                 |                 |<-------+        |
    |                 |                 |                 |                 |
    |                 |                 | 返回响应数据      |                 |
    |                 |<----------------|                 |                 |
    |                 |                 |                 |                 |
    |                 | 显示文本/播放音频  |                 |                 |
    |                 |--------+        |                 |                 |
    |                 |        |        |                 |                 |
    |                 |<-------+        |                 |                 |
    |                 |                 |                 |                 |
    | 接收操作反馈      |                 |                 |                 |
    |<----------------|                 |                 |                 |
    |                 |                 |                 |                 |
```

### 4.3 设备控制序列图

下面是直接通过UI控制设备的序列图：

```
+-------+          +----------+          +---------+          +---------+
| 用户   |          | 前端     |          | 后端     |          | 设备     |
+-------+          +----------+          +---------+          +---------+
    |                   |                    |                    |
    | 点击设备控制按钮    |                    |                    |
    |------------------>|                    |                    |
    |                   |                    |                    |
    |                   | 生成控制请求参数     |                    |
    |                   |-------+            |                    |
    |                   |       |            |                    |
    |                   |<------+            |                    |
    |                   |                    |                    |
    |                   | 发送控制API请求      |                    |
    |                   |------------------->|                    |
    |                   |                    |                    |
    |                   |                    | 验证请求参数        |
    |                   |                    |------+             |
    |                   |                    |      |             |
    |                   |                    |<-----+             |
    |                   |                    |                    |
    |                   |                    | 调用设备服务        |
    |                   |                    |------+             |
    |                   |                    |      |             |
    |                   |                    |<-----+             |
    |                   |                    |                    |
    |                   |                    | 更新设备状态        |
    |                   |                    |------------------->|
    |                   |                    |                    |
    |                   |                    |                    | 执行操作
    |                   |                    |                    |------+
    |                   |                    |                    |      |
    |                   |                    |                    |<-----+
    |                   |                    |                    |
    |                   |                    | 返回操作状态        |
    |                   |                    |<-------------------|
    |                   |                    |                    |
    |                   | 返回响应数据        |                    |
    |                   |<-------------------|                    |
    |                   |                    |                    |
    |                   | 更新UI状态         |                    |
    |                   |-------+            |                    |
    |                   |       |            |                    |
    |                   |<------+            |                    |
    |                   |                    |                    |
    | 观察设备状态变化    |                    |                    |
    |<------------------|                    |                    |
    |                   |                    |                    |
```

### 4.4 类图关系

主要类之间的关系如下：

```
+------------------+       +------------------+       +------------------+
|  DeviceController |------>|   DeviceService   |------>| DeviceRepository |
+------------------+       +------------------+       +------------------+
         |                         |                          |
         |                         |                          |
         v                         v                          v
+------------------+       +------------------+       +------------------+
|  ApiResponse<T>   |<------|    Device        |<------| JpaRepository<T> |
+------------------+       +------------------+       +------------------+
                                  ^
                                  |
+------------------+              |            +------------------+
| VoiceCommandCtrl |--------------|----------->|    NLPService    |
+------------------+                           +------------------+
         |                                             |
         v                                             v
+------------------+                           +------------------+
| SettingsController|                           |   Orchestrator   |
+------------------+                           +------------------+
                                                      |
                                           +----------+----------+
                                           |                     |
                                 +---------v--------+  +---------v--------+
                                 |   STTProcessor   |  |   NLUProcessor   |
                                 +------------------+  +------------------+
```

### 4.5 部署架构图

系统的部署架构如下：

```
+-----------------------------------+
|           用户设备                 |
|  +---------------------------+    |
|  |       Web浏览器           |    |
|  |  +-----------------+     |    |
|  |  |   前端应用(React) |     |    |
|  |  +-----------------+     |    |
|  +---------------------------+    |
+----------------+----------------+
                 |
                 | HTTP/HTTPS
                 |
+----------------v----------------+
|           应用服务器             |
|                                 |
|  +---------------------------+  |
|  |    后端服务(Spring Boot)   |  |
|  +---------------------------+  |
|                                 |
|  +---------------------------+  |
|  |      数据库(H2/MySQL)      |  |
|  +---------------------------+  |
+----------------+----------------+
                 |
                 | HTTP
                 |
+----------------v----------------+
|           NLP服务器             |
|                                 |
|  +---------------------------+  |
|  |   NLP服务(Python/FastAPI)  |  |
|  +---------------------------+  |
|                                 |
|  +---------------------------+  |
|  |      AI模型和语言资源      |  |
|  +---------------------------+  |
+-----------------------------------+
```
